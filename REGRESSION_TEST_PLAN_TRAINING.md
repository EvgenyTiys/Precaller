# ПЛАН РЕГРЕСС ТЕСТИРОВАНИЯ: Три цикла тренировки
**Подготовил:** <Senior QA Engineer>  
**Дата:** 2024  
**Версия:** Текущая  
**Тип тестирования:** Регресс тестирование трёх полных циклов тренировки

---

## ОБЛАСТЬ ТЕСТИРОВАНИЯ

### Функциональные области:
1. Выбор текста для тренировки
2. Инициализация тренировки
3. Навигация между слайдами
4. Ввод пользовательских фраз
5. Управление видимостью элементов
6. Работа секундомера
7. Завершение тренировки
8. Перезапуск тренировки
9. Сохранение данных в localStorage
10. Сохранение сессии в БД

---

## ТЕСТОВЫЕ СЦЕНАРИИ: ТРИ ЦИКЛА ТРЕНИРОВКИ

### ЦИКЛ 1: Первая тренировка

#### TC-001: Выбор текста и инициализация
**Приоритет:** High  
**Предусловия:** Пользователь авторизован, есть готовые тексты

**Шаги:**И проведи полное и всеобъемлющее тестирование приложения.
1. Открыть страницу `/training`
2. Проверить отображение списка доступных текстов
3. Выбрать текст для тренировки
4. Проверить переход на страницу перед тренировкой
5. Проверить отображение названия текста
6. Проверить инициализацию секундомера (00:00)

**Ожидаемый результат:**
- Список текстов отображается корректно
- При выборе текста происходит переход на страницу перед тренировкой
- Название текста отображается правильно
- Секундомер инициализирован на 00:00

---

#### TC-002: Начало тренировки
**Приоритет:** High  
**Предусловия:** Выбран текст, открыта страница перед тренировкой

**Шаги:**
1. Нажать кнопку "Начать тренировку"
2. Проверить запуск секундомера
3. Проверить отображение слайда ввода (currentFragmentIndex = -1)
4. Проверить отображение ассоциации первого фрагмента
5. Проверить наличие поля ввода
6. Проверить отображение кнопки "Далее" (continueBtn)

**Ожидаемый результат:**
- Секундомер запускается и начинает отсчёт
- Отображается слайд ввода с ассоциацией первого фрагмента
- Поле ввода доступно и имеет фокус
- Кнопка "Далее" видна и активна
- Индикатор прогресса показывает все точки как неактивные

---

#### TC-003: Ввод первого фрагмента и переход к фрагментам
**Приоритет:** High  
**Предусловия:** Открыт слайд ввода

**Шаги:**
1. Ввести фразу первого фрагмента в поле ввода
2. Нажать кнопку "Далее" (continueBtn)
3. Проверить сохранение введённой фразы в userInputs[0]
4. Проверить переход к первому фрагменту (currentFragmentIndex = 0)
5. Проверить отображение текста фрагмента
6. Проверить отображение введённой фразы (userInputText)
7. Проверить отображение ассоциации текущего фрагмента
8. Проверить отображение подсказки следующего фрагмента
9. Проверить индикатор прогресса (первая точка активна)

**Ожидаемый результат:**
- Введённая фраза сохраняется в userInputs[0]
- Происходит переход к первому фрагменту
- Текст фрагмента отображается корректно
- Введённая фраза отображается под текстом фрагмента
- Ассоциация и подсказка отображаются правильно
- Индикатор прогресса показывает первую точку как активную

---

#### TC-004: Навигация по фрагментам (вперёд)
**Приоритет:** High  
**Предусловия:** Открыт первый фрагмент

**Шаги:**
1. Ввести фразу следующего фрагмента в поле ввода
2. Нажать кнопку "Далее" (nextBtn) или клавишу "→"
3. Проверить сохранение введённой фразы
4. Проверить переход к следующему фрагменту
5. Повторить для всех фрагментов до последнего
6. Проверить обновление индикатора прогресса на каждом шаге
7. Проверить работу цепочки рассказа (storyChain)

**Ожидаемый результат:**
- Каждая введённая фраза сохраняется в соответствующий индекс userInputs
- Навигация работает корректно
- Индикатор прогресса обновляется правильно
- Цепочка рассказа обновляется с активным фрагментом

---

#### TC-005: Навигация назад по фрагментам
**Приоритет:** Medium  
**Предусловия:** Открыт фрагмент с индексом > 0

**Шаги:**
1. Находясь на втором фрагменте, нажать кнопку "Назад" или клавишу "←"
2. Проверить переход к предыдущему фрагменту
3. Проверить отображение сохранённой введённой фразы
4. Проверить, что поле ввода содержит фразу следующего фрагмента
5. Повторить навигацию назад до первого фрагмента
6. На первом фрагменте нажать "Назад"
7. Проверить возврат к слайду ввода

**Ожидаемый результат:**
- Навигация назад работает корректно
- Сохранённые фразы отображаются правильно
- При возврате к слайду ввода отображается сохранённая фраза первого фрагмента

---

#### TC-006: Прямой переход к фрагменту через индикатор
**Приоритет:** Medium  
**Предусловия:** Открыт любой фрагмент

**Шаги:**
1. Кликнуть на точку индикатора прогресса, соответствующую другому фрагменту
2. Проверить переход к выбранному фрагменту
3. Проверить отображение сохранённых данных
4. Кликнуть на элемент цепочки рассказа
5. Проверить переход к соответствующему фрагменту

**Ожидаемый результат:**
- Прямой переход работает корректно
- Сохранённые данные отображаются правильно
- Цепочка рассказа позволяет переходить к фрагментам

---

#### TC-007: Управление видимостью элементов
**Приоритет:** Medium  
**Предусловия:** Открыт любой фрагмент

**Шаги:**
1. Нажать кнопку "Скрыть текст" (клавиша 'h')
2. Проверить скрытие текста фрагмента
3. Нажать кнопку "Скрыть смайлики" (клавиша 'e')
4. Проверить скрытие ассоциаций и подсказок
5. Нажать кнопку "Скрыть секундомер" (клавиша 't')
6. Проверить скрытие секундомера
7. Повторить действия для показа элементов

**Ожидаемый результат:**
- Все элементы управления видимостью работают корректно
- Состояние видимости сохраняется при навигации
- Клавиатурные сокращения работают

---

#### TC-008: Работа секундомера
**Приоритет:** High  
**Предусловия:** Тренировка начата

**Шаги:**
1. Проверить запуск секундомера при начале тренировки
2. Проверить обновление времени каждую секунду
3. Нажать кнопку "Остановить" секундомер
4. Проверить остановку секундомера
5. Проверить, что время не обновляется
6. Проверить отображение времени в двух местах (большой и маленький)

**Ожидаемый результат:**
- Секундомер запускается и работает корректно
- Время обновляется синхронно в обоих местах
- Остановка секундомера работает правильно

---

#### TC-009: Завершение тренировки
**Приоритет:** Critical  
**Предусловия:** Открыт последний фрагмент

**Шаги:**
1. Ввести фразу последнего фрагмента (если не введена)
2. Нажать кнопку "Завершить тренировку" или пробел
3. Проверить остановку секундомера
4. Проверить сохранение данных в localStorage (pendingTrainingSession)
5. Проверить отправку запроса на сервер
6. Проверить успешное сохранение сессии в БД
7. Проверить удаление данных из localStorage после успеха
8. Проверить отображение кнопки "В начало" вместо "Завершить тренировку"
9. Проверить обновление заголовка на "Тренировка завершена"

**Ожидаемый результат:**
- Секундомер останавливается
- Данные сохраняются в localStorage перед отправкой
- Запрос на сервер отправляется корректно
- После успешного сохранения данные удаляются из localStorage
- UI обновляется правильно
- Кнопка "В начало" отображается

---

#### TC-010: Обработка ошибки при завершении тренировки
**Приоритет:** Critical  
**Предусловия:** Открыт последний фрагмент

**Шаги:**
1. Отключить интернет (имитация ошибки сети)
2. Нажать кнопку "Завершить тренировку"
3. Проверить остановку секундомера
4. Проверить сохранение данных в localStorage
5. Проверить отображение ошибки
6. Проверить появление кнопки "Повторить сохранение"
7. Включить интернет
8. Нажать "Повторить сохранение"
9. Проверить успешное сохранение

**Ожидаемый результат:**
- При ошибке данные остаются в localStorage
- Отображается кнопка "Повторить сохранение"
- При повторе данные восстанавливаются из localStorage
- После успеха данные удаляются из localStorage

---

### ЦИКЛ 2: Перезапуск тренировки

#### TC-011: Перезапуск через кнопку "В начало"
**Приоритет:** High  
**Предусловия:** Тренировка завершена (Цикл 1)

**Шаги:**
1. Нажать кнопку "В начало" (restartBtn) или клавишу 'r'
2. Проверить вызов функции cleanupTraining()
3. Проверить остановку и сброс секундомера
4. Проверить очистку массива userInputs
5. Проверить сброс currentFragmentIndex
6. Проверить возврат на страницу перед тренировкой (trainingStart)
7. Проверить сброс состояния видимости элементов
8. Проверить очистку trainingFragments

**Ожидаемый результат:**
- Все данные очищаются корректно
- Происходит возврат на страницу перед тренировкой
- Секундомер сброшен на 00:00
- Состояние полностью сброшено

---

#### TC-012: Повторная тренировка после перезапуска
**Приоритет:** High  
**Предусловия:** Тренировка перезапущена (TC-011)

**Шаги:**
1. Выполнить шаги TC-002 (Начало тренировки)
2. Выполнить шаги TC-003 (Ввод первого фрагмента)
3. Выполнить шаги TC-004 (Навигация вперёд)
4. Выполнить шаги TC-009 (Завершение тренировки)
5. Проверить, что все функции работают так же, как в первом цикле
6. Проверить отсутствие остатков данных из предыдущего цикла

**Ожидаемый результат:**
- Все функции работают идентично первому циклу
- Нет остатков данных из предыдущего цикла
- Секундомер начинает отсчёт с 00:00
- Все введённые фразы сохраняются заново

---

### ЦИКЛ 3: Третий перезапуск и тренировка

#### TC-013: Второй перезапуск
**Приоритет:** High  
**Предусловия:** Тренировка завершена (Цикл 2)

**Шаги:**
1. Выполнить шаги TC-011 (Перезапуск)
2. Проверить корректность очистки после второго цикла
3. Проверить отсутствие утечек памяти

**Ожидаемый результат:**
- Очистка работает корректно
- Нет утечек памяти
- Все интервалы и обработчики очищены

---

#### TC-014: Третья тренировка
**Приоритет:** High  
**Предусловия:** Тренировка перезапущена второй раз (TC-013)

**Шаги:**
1. Выполнить полный цикл тренировки (TC-002 → TC-009)
2. Проверить стабильность работы после двух перезапусков
3. Проверить корректность сохранения всех трёх сессий в БД
4. Проверить отсутствие конфликтов между сессиями

**Ожидаемый результат:**
- Все функции работают стабильно
- Все три сессии сохраняются в БД
- Нет конфликтов между сессиями
- Производительность не деградирует

---

## ДОПОЛНИТЕЛЬНЫЕ ТЕСТОВЫЕ СЦЕНАРИИ

### TC-015: Переключение между текстами
**Приоритет:** Medium  
**Предусловия:** Тренировка начата

**Шаги:**
1. Во время тренировки нажать "Выбрать текст"
2. Проверить вызов cleanupTraining()
3. Проверить очистку состояния
4. Выбрать другой текст
5. Проверить загрузку нового текста
6. Проверить отсутствие остатков от предыдущего текста

**Ожидаемый результат:**
- При переключении текста состояние полностью очищается
- Новый текст загружается корректно
- Нет остатков от предыдущего текста

---

### TC-016: Клавиатурные сокращения
**Приоритет:** Low  
**Предусловия:** Открыт любой фрагмент

**Шаги:**
1. Проверить все клавиатурные сокращения:
   - ← (ArrowLeft) - назад
   - → (ArrowRight) - вперёд
   - Пробел - вперёд/завершить
   - 'h'/'H' - скрыть/показать текст
   - 'e'/'E' - скрыть/показать смайлики
   - 'r'/'R' - перезапуск
2. Проверить работу в поле ввода
3. Проверить работу на разных слайдах

**Ожидаемый результат:**
- Все клавиатурные сокращения работают корректно
- В поле ввода работают специальные случаи
- Нет конфликтов между обработчиками

---

### TC-017: Защита от race condition
**Приоритет:** Medium  
**Предусловия:** Открыт любой фрагмент

**Шаги:**
1. Быстро нажать кнопку "Далее" несколько раз подряд
2. Проверить, что навигация происходит только один раз
3. Проверить работу флага isNavigating
4. Повторить для кнопки "Назад"
5. Проверить работу при клике на индикатор прогресса

**Ожидаемый результат:**
- Повторные нажатия игнорируются
- Флаг isNavigating работает корректно
- Нет гонок при навигации

---

### TC-018: Граничные случаи
**Приоритет:** Medium

**Сценарии:**
1. Текст с одним фрагментом
2. Текст с максимальным количеством фрагментов
3. Пустой ввод фраз
4. Очень длинный ввод фраз
5. Специальные символы в вводе
6. Emoji в вводе

**Ожидаемый результат:**
- Все граничные случаи обрабатываются корректно
- Нет ошибок при экстремальных значениях

---

### TC-019: Восстановление из localStorage
**Приоритет:** Medium  
**Предусловия:** Тренировка завершена с ошибкой

**Шаги:**
1. Завершить тренировку с ошибкой сети
2. Перезагрузить страницу
3. Проверить наличие данных в localStorage
4. Проверить возможность восстановления сессии
5. Проверить функцию retryFinishTraining()

**Ожидаемый результат:**
- Данные сохраняются в localStorage
- Возможно восстановление после перезагрузки
- Функция повтора работает корректно

---

## КРИТЕРИИ ПРОХОЖДЕНИЯ ТЕСТОВ

### Обязательные критерии (Must Have):
- ✅ Все тесты TC-001 - TC-014 проходят успешно
- ✅ Нет критических багов (P0)
- ✅ Нет потери данных
- ✅ Нет утечек памяти
- ✅ Все три цикла тренировки работают стабильно

### Желательные критерии (Should Have):
- ✅ Все тесты TC-015 - TC-019 проходят успешно
- ✅ Нет высоких багов (P1)
- ✅ Производительность не деградирует

### Опциональные критерии (Nice to Have):
- ✅ Нет средних багов (P2)
- ✅ Все улучшения реализованы

---

## МЕТРИКИ ТЕСТИРОВАНИЯ

### Покрытие тестами:
- Функциональное покрытие: 100% основных сценариев
- Покрытие граничных случаев: > 80%
- Покрытие обработки ошибок: > 90%

### Производительность:
- Время загрузки текста: < 1 секунда
- Время навигации между слайдами: < 100ms
- Использование памяти: стабильное, без утечек

### Стабильность:
- Успешность прохождения всех трёх циклов: 100%
- Количество ошибок за цикл: 0
- Время работы без перезагрузки: > 30 минут

---

## ОТЧЁТ О РЕЗУЛЬТАТАХ

После выполнения всех тестов будет составлен отчёт, включающий:
1. Статус прохождения каждого теста
2. Найденные баги с приоритетами
3. Проблемы производительности
4. Рекомендации по улучшению

---

**Подготовил:** <Senior QA Engineer>  
**Дата:** 2024

